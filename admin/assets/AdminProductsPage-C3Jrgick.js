import{r as c,u as f,j as e}from"./index-D87h4XFq.js";import{A as w,f as N}from"./AdminLayout-P-00iwzM.js";import{B as p}from"./Button-nMgvLXDK.js";import{o as k,p as y,A as S,t as P,q as A,s as C}from"./api-Cg0uqViC.js";function D(){const[a,u]=c.useState([]),[x,i]=c.useState(!0),[s,r]=c.useState("list"),[g,h]=c.useState(null),l=f();c.useEffect(()=>{t()},[]);const t=async()=>{i(!0);const m=localStorage.getItem("admin_token");if(!m){l("/login");return}try{const n=await k(m,1);u(n.items.map(y))}catch(n){console.error("Failed to load products:",n),n instanceof S&&n.status===401&&(localStorage.removeItem("admin_token"),l("/login"))}finally{i(!1)}},o=async m=>{const n=localStorage.getItem("admin_token");if(n)try{await P(n,parseInt(m.id)),t()}catch{alert("Gagal update status produk")}},d=m=>{h(m),r("edit")},b=()=>{h(null),r("create")},v=async()=>{r("list"),t()},j=s==="list"&&e.jsx(p,{size:"sm",onClick:b,children:"+ Tambah Produk"});return e.jsx(w,{title:"Products",actions:j,children:s==="list"?e.jsx(_,{products:a,isLoading:x,onEdit:d,onToggleActive:o}):e.jsx(z,{product:g||void 0,onSubmit:v,onCancel:()=>r("list")})})}function _({products:a,isLoading:u,onEdit:x,onToggleActive:i}){return u?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,r)=>e.jsx("div",{className:"bg-[#1e1e26] h-24 rounded-xl animate-pulse"},r))}):e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:`bg-[#1e1e26] rounded-xl border p-4 flex gap-4 items-center ${s.isSoldOut?"border-red-500/20":"border-white/5"}`,children:[e.jsx("div",{className:"w-16 h-16 bg-zinc-800 rounded-lg overflow-hidden shrink-0",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:s.title}),s.isSoldOut?e.jsx("span",{className:"text-[10px] bg-zinc-500/20 text-zinc-400 px-2 py-0.5 rounded",children:"Inactive"}):e.jsx("span",{className:"text-[10px] bg-emerald-500/20 text-emerald-400 px-2 py-0.5 rounded",children:"Active"}),s.badge&&e.jsx("span",{className:"text-[10px] bg-slate-400/20 text-slate-300 px-2 py-0.5 rounded uppercase",children:s.badge})]}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[N(s.price)," â€¢ ",s.category]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>x(s),className:"px-3 py-1.5 bg-slate-400/10 text-slate-300 hover:bg-slate-400/20 rounded-lg text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>i(s),className:`px-3 py-1.5 rounded-lg text-sm ${s.isSoldOut?"bg-emerald-500/10 text-emerald-400 hover:bg-emerald-500/20":"bg-red-500/10 text-red-400 hover:bg-red-500/20"}`,children:s.isSoldOut?"Activate":"Deactivate"})]})]},s.id))})}function z({product:a,onSubmit:u,onCancel:x}){const[i,s]=c.useState({title:a?.title||"",slug:a?.slug||"",description_short:a?.description||"",description_full:a?.descriptionFull||"",price_idr:a?.price||0,category:a?.category||"indikator",images:a?.images||[a?.imageUrl||""],badges:a?.badge?[a.badge]:[],is_active:!a?.isSoldOut}),[r,g]=c.useState(!1),h=async t=>{t.preventDefault(),g(!0);const o=localStorage.getItem("admin_token");if(o)try{a?await A(o,parseInt(a.id),i):await C(o,i),u()}catch(d){const b=d instanceof Error?d.message:String(d);alert("Error: "+b)}finally{g(!1)}},l=(t,o)=>{s(d=>({...d,[t]:o}))};return e.jsxs("div",{className:"bg-[#1e1e26] rounded-2xl p-6 border border-white/5",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:a?"Edit Produk":"Tambah Produk Baru"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Nama Produk"}),e.jsx("input",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.title,onChange:t=>l("title",t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Slug (URL)"}),e.jsx("input",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.slug,onChange:t=>l("slug",t.target.value),required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Deskripsi Singkat"}),e.jsx("textarea",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.description_short,onChange:t=>l("description_short",t.target.value),required:!0,rows:2})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Deskripsi Lengkap"}),e.jsx("textarea",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.description_full,onChange:t=>l("description_full",t.target.value),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Harga (IDR)"}),e.jsx("input",{type:"number",className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.price_idr,onChange:t=>l("price_idr",parseInt(t.target.value)),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Kategori"}),e.jsxs("select",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.category,onChange:t=>l("category",t.target.value),children:[e.jsx("option",{value:"indikator",children:"Indikator"}),e.jsx("option",{value:"robot",children:"Robot EA"}),e.jsx("option",{value:"ebook",children:"Ebook"}),e.jsx("option",{value:"merchandise",children:"Merchandise"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Badge (Optional)"}),e.jsxs("select",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.badges?.[0]||"",onChange:t=>l("badges",t.target.value?[t.target.value]:[]),children:[e.jsx("option",{value:"",children:"None"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"popular",children:"Popular"}),e.jsx("option",{value:"bestseller",children:"Bestseller"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Image URL"}),e.jsx("input",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:i.images?.[0]||"",onChange:t=>l("images",[t.target.value]),placeholder:"https://...",required:!0})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(p,{type:"submit",isLoading:r,children:a?"Simpan Perubahan":"Buat Produk"}),e.jsx(p,{variant:"ghost",type:"button",onClick:x,children:"Batal"})]})]})]})}export{D as AdminProductsPage};
