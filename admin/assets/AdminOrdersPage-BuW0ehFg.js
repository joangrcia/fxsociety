import{r as i,u as h,j as e}from"./index-D6uktYsn.js";import{A as f,g as o,b as j,a as b,f as N}from"./AdminLayout-CCsnW7a4.js";import{a as v,c as y,A as k,u as w}from"./api-Cg0uqViC.js";function O(){const[t,n]=i.useState([]),[m,c]=i.useState(!0),[l,x]=i.useState("all"),u=h();i.useEffect(()=>{r()},[l]);const r=async()=>{c(!0);const s=localStorage.getItem("admin_token");if(s)try{const a=await v(s,l);n(a.items.map(y))}catch(a){console.error("Failed to load orders:",a),a instanceof k&&a.status===401&&(localStorage.removeItem("admin_token"),u("/login"))}finally{c(!1)}},p=async(s,a)=>{if(!s.numericId||!confirm(`Ubah status pesanan ${s.id} menjadi ${o(a)}?`))return;const d=localStorage.getItem("admin_token");if(d)try{await w(d,s.numericId,a),r()}catch{alert("Gagal update status")}},g=e.jsxs("select",{value:l,onChange:s=>x(s.target.value),className:"bg-[#1e1e26] text-zinc-300 text-sm rounded-lg border border-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-orange-500",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Menunggu Konfirmasi"}),e.jsx("option",{value:"confirmed",children:"Dikonfirmasi"}),e.jsx("option",{value:"completed",children:"Selesai"}),e.jsx("option",{value:"cancelled",children:"Dibatalkan"})]});return e.jsx(f,{title:"Manajemen Pesanan",actions:g,children:m?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"bg-[#1e1e26] rounded-2xl p-5 animate-pulse h-32"},a))}):t.length>0?e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsx(S,{order:s,onUpdateStatus:p},s.id))}):e.jsx("div",{className:"text-center py-16 bg-[#1e1e26] rounded-2xl border border-white/5",children:e.jsx("p",{className:"text-zinc-400",children:"Tidak ada pesanan ditemukan."})})})}function S({order:t,onUpdateStatus:n}){return e.jsx("div",{className:"bg-[#1e1e26] rounded-xl border border-white/5 p-5",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-mono text-zinc-500 bg-white/5 px-2 py-1 rounded",children:t.id}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium border ${j(t.status)}`,children:o(t.status)})]}),e.jsx("span",{className:"text-sm text-zinc-500",children:b(t.createdAt)})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium text-lg",children:t.productTitle}),e.jsx("p",{className:"text-orange-400 font-bold",children:N(t.productPrice)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider mb-1",children:"Customer"}),e.jsx("p",{className:"text-zinc-300 font-medium",children:t.customerName}),e.jsx("p",{className:"text-zinc-400",children:t.customerEmail}),e.jsx("p",{className:"text-zinc-400",children:t.customerWhatsapp})]}),t.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-zinc-500 text-xs uppercase tracking-wider mb-1",children:"Catatan"}),e.jsxs("p",{className:"text-zinc-300 italic",children:['"',t.notes,'"']})]})]})]}),e.jsxs("div",{className:"lg:w-48 flex flex-col gap-2 justify-center border-t lg:border-t-0 lg:border-l border-white/5 pt-4 lg:pt-0 lg:pl-6",children:[e.jsx("p",{className:"text-xs text-zinc-500 uppercase tracking-wider mb-1 text-center lg:text-left",children:"Update Status"}),t.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>n(t,"confirmed"),className:"w-full px-3 py-2 bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 rounded-lg text-sm font-medium transition-colors",children:"Konfirmasi"}),e.jsx("button",{onClick:()=>n(t,"cancelled"),className:"w-full px-3 py-2 bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg text-sm font-medium transition-colors",children:"Batalkan"})]}),t.status==="confirmed"&&e.jsx("button",{onClick:()=>n(t,"completed"),className:"w-full px-3 py-2 bg-orange-500/10 text-orange-400 hover:bg-orange-500/20 rounded-lg text-sm font-medium transition-colors",children:"Selesaikan"}),t.status==="completed"&&e.jsx("span",{className:"text-center text-xs text-emerald-500 font-medium py-2",children:"Order Selesai"}),t.status==="cancelled"&&e.jsx("button",{onClick:()=>n(t,"pending"),className:"w-full px-3 py-2 bg-zinc-700/30 text-zinc-400 hover:bg-zinc-700/50 rounded-lg text-sm font-medium transition-colors",children:"Reset ke Pending"})]})]})})}export{O as AdminOrdersPage};
