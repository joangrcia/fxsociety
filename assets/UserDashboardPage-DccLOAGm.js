import{r as c,b as w,n as k,o as y,m as z,A as S,j as e,L as f,B as x,p as T}from"./index-BHTB0fsH.js";import{g as L,a as C,b as M,f as P}from"./orders-C0ZHXr8-.js";function _(){const[t,a]=c.useState("overview"),[s,n]=c.useState([]),[l,r]=c.useState([]),[b,p]=c.useState(!0),m=w(),i=localStorage.getItem("user_email");c.useEffect(()=>{const d=localStorage.getItem("auth_token");if(!d){m("/login");return}h(d)},[]);const h=async d=>{try{const[o,j]=await Promise.all([k(d),y(d)]);n(o.items.map(z)),r(j.items)}catch(o){console.error("Failed to load dashboard data:",o),o instanceof S&&o.status===401&&(localStorage.removeItem("auth_token"),m("/login"))}finally{p(!1)}},N=()=>{localStorage.removeItem("auth_token"),localStorage.removeItem("user_email"),m("/"),window.location.reload()},u=({tab:d,label:o,icon:j})=>e.jsxs("button",{onClick:()=>a(d),className:`w-full flex items-center gap-3 px-4 py-3 text-sm font-medium transition-colors ${t===d?"bg-emerald-500/10 text-emerald-400 border-r-2 border-emerald-400":"text-zinc-400 hover:text-white hover:bg-white/5"}`,children:[j,o]});return e.jsxs("div",{className:"min-h-screen pt-16 bg-[#0a0a0f]",children:[e.jsx("aside",{className:"w-64 bg-[#14141a] border-r border-white/5 fixed h-[calc(100vh-4rem)] hidden md:block overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xs font-bold text-zinc-500 uppercase tracking-wider mb-4",children:"Menu"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{tab:"overview",label:"Ringkasan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),e.jsx(u,{tab:"orders",label:"Pesanan Saya",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsx(u,{tab:"products",label:"Produk Saya",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx(u,{tab:"tickets",label:"Bantuan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsx(u,{tab:"profile",label:"Akun",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})]})]})}),e.jsx("div",{className:"md:hidden fixed top-16 left-0 right-0 bg-[#14141a] border-b border-white/5 z-40 overflow-x-auto",children:e.jsxs("div",{className:"flex px-4",children:[e.jsx("button",{onClick:()=>a("overview"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${t==="overview"?"text-emerald-400 border-b-2 border-emerald-400":"text-zinc-400"}`,children:"Ringkasan"}),e.jsx("button",{onClick:()=>a("orders"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${t==="orders"?"text-emerald-400 border-b-2 border-emerald-400":"text-zinc-400"}`,children:"Pesanan"}),e.jsx("button",{onClick:()=>a("products"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${t==="products"?"text-emerald-400 border-b-2 border-emerald-400":"text-zinc-400"}`,children:"Produk"}),e.jsx("button",{onClick:()=>a("tickets"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${t==="tickets"?"text-emerald-400 border-b-2 border-emerald-400":"text-zinc-400"}`,children:"Bantuan"}),e.jsx("button",{onClick:()=>a("profile"),className:`px-4 py-3 text-sm font-medium whitespace-nowrap ${t==="profile"?"text-emerald-400 border-b-2 border-emerald-400":"text-zinc-400"}`,children:"Akun"})]})}),e.jsx("main",{className:"md:ml-64 p-4 md:p-8 mt-12 md:mt-0",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[t==="overview"&&e.jsx(B,{orders:s,tickets:l,userEmail:i}),t==="orders"&&e.jsx(I,{orders:s,isLoading:b}),t==="products"&&e.jsx(A,{orders:s}),t==="tickets"&&e.jsx($,{tickets:l,refresh:()=>h(localStorage.getItem("auth_token")||"")}),t==="profile"&&e.jsx(D,{userEmail:i,onLogout:N})]})})]})}function B({orders:t,tickets:a,userEmail:s}){const n=t.filter(r=>r.status==="confirmed"||r.status==="completed").length,l=a.filter(r=>r.status==="open").length;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Selamat Datang, Trader"}),e.jsx("p",{className:"text-zinc-400 text-sm",children:s})]}),e.jsx(f,{to:"/shop",children:e.jsx(x,{children:"Belanja Lagi"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(v,{label:"Total Pesanan",value:t.length,icon:"ðŸ›ï¸"}),e.jsx(v,{label:"Produk Dimiliki",value:n,icon:"ðŸ“¦"}),e.jsx(v,{label:"Tiket Terbuka",value:l,icon:"ðŸŽ«",color:l>0?"text-slate-300":void 0})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Aktivitas Terbaru"}),t.length>0?e.jsx("div",{className:"space-y-4",children:t.slice(0,3).map(r=>e.jsx(g,{order:r,simple:!0},r.id))}):e.jsx("div",{className:"text-center py-8 bg-[#1e1e26] rounded-xl border border-white/5",children:e.jsx("p",{className:"text-zinc-500",children:"Belum ada aktivitas."})})]})]})}function v({label:t,value:a,icon:s,color:n="text-white"}){return e.jsxs("div",{className:"bg-[#1e1e26] p-6 rounded-xl border border-white/5 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-zinc-400 text-sm",children:t}),e.jsx("p",{className:`text-2xl font-bold mt-1 ${n}`,children:a})]}),e.jsx("div",{className:"text-2xl opacity-50",children:s})]})}function I({orders:t,isLoading:a}){return e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Riwayat Pesanan"}),a?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsx("div",{className:"bg-[#1e1e26] h-24 rounded-xl"}),e.jsx("div",{className:"bg-[#1e1e26] h-24 rounded-xl"})]}):t.length>0?e.jsx("div",{className:"space-y-4",children:t.map(s=>e.jsx(g,{order:s},s.id))}):e.jsxs("div",{className:"text-center py-12 bg-[#1e1e26] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-zinc-400 mb-4",children:"Belum ada pesanan."}),e.jsx(f,{to:"/shop",children:e.jsx(x,{children:"Mulai Belanja"})})]})]})}function A({orders:t}){const a=t.filter(s=>s.status==="confirmed"||s.status==="completed");return e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Produk Saya"}),a.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(s=>e.jsxs("div",{className:"bg-[#1e1e26] p-5 rounded-xl border border-white/5 flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 bg-zinc-800 rounded-lg overflow-hidden shrink-0",children:s.productImage?e.jsx("img",{src:s.productImage,alt:s.productTitle,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-zinc-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-medium",children:s.productTitle}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1 uppercase",children:s.productCategory||"Produk"}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-emerald-500/10 text-emerald-400 text-xs rounded",children:s.status==="completed"?"Aktif":"Menunggu Akses"}),s.status==="completed"&&e.jsx("button",{className:"text-xs text-zinc-300 hover:text-white border border-white/10 px-3 py-1 rounded transition-colors",children:"Akses"})]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-12 bg-[#1e1e26] rounded-xl border border-white/5",children:[e.jsx("p",{className:"text-zinc-400 mb-4",children:"Anda belum memiliki produk."}),e.jsx(f,{to:"/shop",children:e.jsx(x,{children:"Lihat Katalog"})})]})]})}function $({tickets:t,refresh:a}){const[s,n]=c.useState(!1),[l,r]=c.useState({title:"",message:""}),[b,p]=c.useState(!1),m=async i=>{i.preventDefault(),p(!0);const h=localStorage.getItem("auth_token");if(h)try{await T(h,l),r({title:"",message:""}),n(!1),a()}catch{}finally{p(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Bantuan / Tiket"}),e.jsx(x,{size:"sm",onClick:()=>n(!s),children:s?"Batal":"+ Buat Tiket"})]}),s&&e.jsxs("div",{className:"bg-[#1e1e26] p-6 rounded-xl border border-white/5 mb-8 animate-fade-in",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Tiket Baru"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Judul"}),e.jsx("input",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:l.title,onChange:i=>r({...l,title:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-zinc-400 mb-1",children:"Pesan"}),e.jsx("textarea",{className:"w-full bg-[#14141a] text-white rounded p-2 border border-white/10",value:l.message,onChange:i=>r({...l,message:i.target.value}),rows:3,required:!0})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{type:"submit",isLoading:b,children:"Kirim Tiket"})})]})]}),e.jsx("div",{className:"space-y-4",children:t.length>0?t.map(i=>e.jsx("div",{className:"bg-[#1e1e26] p-5 rounded-xl border border-white/5",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:i.title}),e.jsx("p",{className:"text-zinc-400 text-sm mt-1",children:i.message}),e.jsx("p",{className:"text-zinc-600 text-xs mt-3",children:new Date(i.created_at).toLocaleDateString("id-ID")})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded capitalize ${i.status==="open"?"bg-emerald-500/10 text-emerald-400":i.status==="closed"?"bg-zinc-500/10 text-zinc-400":"bg-slate-400/10 text-slate-300"}`,children:i.status})]})},i.id)):e.jsx("p",{className:"text-zinc-500 text-center py-8",children:"Belum ada tiket bantuan."})})]})}function D({userEmail:t,onLogout:a}){return e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Pengaturan Akun"}),e.jsxs("div",{className:"bg-[#1e1e26] p-6 rounded-xl border border-white/5 max-w-xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm text-zinc-500 mb-1",children:"Email Terdaftar"}),e.jsx("p",{className:"text-white font-mono",children:t})]}),e.jsx("div",{className:"border-t border-white/5 pt-6",children:e.jsx(x,{variant:"secondary",onClick:a,children:"Logout dari Perangkat Ini"})})]})]})}function g({order:t,simple:a}){const[s,n]=c.useState(!1);return e.jsxs("div",{className:"bg-[#1e1e26] rounded-xl border border-white/5 overflow-hidden transition-all hover:border-white/10",children:[e.jsx("div",{className:"p-5 cursor-pointer",onClick:()=>!a&&n(!s),children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:"text-xs font-mono text-zinc-500",children:t.id}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-medium border ${C(t.status)}`,children:L(t.status)})]}),e.jsx("h3",{className:"text-white font-medium truncate",children:t.productTitle}),!a&&e.jsx("p",{className:"text-sm text-zinc-500",children:M(t.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-emerald-400 font-bold text-sm",children:P(t.productPrice)}),!a&&e.jsx("svg",{className:`w-5 h-5 text-zinc-500 transition-transform ${s?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),s&&!a&&e.jsx("div",{className:"px-5 pb-5 pt-0 border-t border-white/5 bg-[#14141a]/50",children:e.jsxs("div",{className:"pt-4 space-y-2 text-sm text-zinc-400",children:[e.jsxs("p",{children:["Whatsapp: ",e.jsx("span",{className:"text-zinc-300",children:t.customerWhatsapp})]}),t.notes&&e.jsxs("p",{children:["Catatan: ",e.jsx("span",{className:"text-zinc-300",children:t.notes})]})]})})]})}export{_ as UserDashboardPage};
